<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</title>
    <style>
        body { font-family: 'Sarabun', sans-serif; margin: 0; padding: 1em; background-color: #f0f2f5; }
        .container { max-width: 600px; margin: auto; background: white; padding: 2em; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #1c1e21; }
        .form-group { margin-bottom: 1.5em; }
        label { display: block; margin-bottom: 0.5em; font-weight: bold; color: #4b4f56; }
        select, textarea, button { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #dddfe2; font-size: 1em; font-family: 'Sarabun', sans-serif; box-sizing: border-box; }
        textarea { height: 150px; resize: vertical; }
        button { background-color: #1877f2; color: white; font-weight: bold; border: none; cursor: pointer; transition: background-color 0.3s; }
        button:hover { background-color: #166fe5; }
        #result-container { margin-top: 2em; padding: 1em; background: #f7f7f7; border-radius: 6px; }
        .result-item { padding: 0.8em; border-bottom: 1px solid #e0e0e0; }
        .result-item:last-child { border-bottom: none; }
        .win { color: green; font-weight: bold; }
        .lose { color: #888; }
        .win::after { content: ' ‚úÖ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•'; }
        .loader { text-align: center; display: none; padding: 1em; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="container">
        <h1>üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h1>

        <div class="form-group">
            <label for="lotto-type">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡∏ß‡∏¢</label>
            <select id="lotto-type">
                <option value="‡∏Æ‡∏≤‡∏ô‡∏≠‡∏¢ ‡∏õ‡∏Å‡∏ï‡∏¥">‡∏Æ‡∏≤‡∏ô‡∏≠‡∏¢ ‡∏õ‡∏Å‡∏ï‡∏¥</option>
                <option value="‡∏•‡∏≤‡∏ß‡∏û‡∏±‡∏í‡∏ô‡∏≤">‡∏•‡∏≤‡∏ß‡∏û‡∏±‡∏í‡∏ô‡∏≤</option>
                <option value="‡∏Æ‡∏≤‡∏ô‡∏≠‡∏¢ ‡∏û‡∏¥‡πÄ‡∏®‡∏©">‡∏Æ‡∏≤‡∏ô‡∏≠‡∏¢ ‡∏û‡∏¥‡πÄ‡∏®‡∏©</option>
                </select>
        </div>

        <div class="form-group">
            <label for="user-numbers">‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠ (‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏Ñ‡∏∑‡∏≠ 1 ‡πÄ‡∏•‡∏Ç)</label>
            <textarea id="user-numbers" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
095,5,,5
065,5,,5
95,10,10,
59,10,10,
65,10,10,
56,10,10,"></textarea>
            <small>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ‡πÄ‡∏•‡∏Ç,‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ö‡∏ô,‡∏£‡∏≤‡∏Ñ‡∏≤‡∏•‡πà‡∏≤‡∏á,‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏ï‡πä‡∏î (‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á)</small>
        </div>

        <button id="check-button">‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>

        <div class="loader" id="loader">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</div>
        <div id="result-container"></div>
    </div>

    <script>
        // -----------------------------------------------------------------
        // ‚ú® ‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå CSV ‡∏Ç‡∏≠‡∏á "‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•" ‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤ ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ‚ú®
        // -----------------------------------------------------------------
        const winningSheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQiBp4Z2XVrllF6aly9pAtFZexQmMfz3fHvvQQE2o5HfhtioEWj4KWTj7uXZh_xwm5Fbi336KKipD4_/pub?output=csv';

        const checkButton = document.getElementById('check-button');
        checkButton.addEventListener('click', checkLottoResults);

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô‡∏™‡∏ï‡∏£‡∏¥‡∏á (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡πÇ‡∏ï‡πä‡∏î)
        const sortString = (str) => str.split('').sort().join('');

        async function checkLottoResults() {
            const lottoType = document.getElementById('lotto-type').value;
            const userNumbersRaw = document.getElementById('user-numbers').value.trim();
            const resultContainer = document.getElementById('result-container');
            const loader = document.getElementById('loader');

            resultContainer.innerHTML = '';
            if (!userNumbersRaw) {
                resultContainer.innerHTML = '<p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</p>';
                return;
            }

            loader.style.display = 'block';
            checkButton.disabled = true;

            try {
                // 1. ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏≤‡∏Å Google Sheet
                const response = await fetch(winningSheetUrl);
                const csvText = await response.text();
                const winningRows = csvText.split('\n');
                const headers = winningRows[0].split(',');

                // 2. ‡∏´‡∏≤‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                let winningNumbers = null;
                const todayWinningRow = winningRows.slice(1).find(row => row.split(',')[headers.indexOf('LotteryName')] === lottoType);

                if (todayWinningRow) {
                    const cols = todayWinningRow.split(',');
                    winningNumbers = {
                        top3: cols[headers.indexOf('Prize3Top')]?.trim(),
                        bottom2: cols[headers.indexOf('Prize2Bottom')]?.trim(),
                    };
                } else {
                    resultContainer.innerHTML = `<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "${lottoType}" ‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>`;
                    loader.style.display = 'none';
                    checkButton.disabled = false;
                    return;
                }

                // 3. ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏Å
                const userBets = userNumbersRaw.split('\n').map(line => {
                    const parts = line.split(',');
                    return {
                        number: parts[0]?.trim(),
                        betTop: parts[1]?.trim(),
                        betBottom: parts[2]?.trim(),
                        betTod: parts[3]?.trim()
                    };
                });

                // 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                let finalHtml = '<h3>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:</h3>';
                userBets.forEach(bet => {
                    let isWin = false;

                    // ‡∏ï‡∏£‡∏ß‡∏à 3 ‡∏ï‡∏±‡∏ß‡∏ö‡∏ô
                    if (bet.number === winningNumbers.top3 && bet.betTop) {
                        isWin = true;
                    }
                    // ‡∏ï‡∏£‡∏ß‡∏à 2 ‡∏ï‡∏±‡∏ß‡∏•‡πà‡∏≤‡∏á (‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏µ 2 ‡∏ï‡∏±‡∏ß)
                    if (bet.number === winningNumbers.bottom2 && bet.betBottom) {
                        isWin = true;
                    }
                    // ‡∏ï‡∏£‡∏ß‡∏à 2 ‡∏ï‡∏±‡∏ß‡∏ö‡∏ô (‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏µ 2 ‡∏ï‡∏±‡∏ß ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö 2 ‡∏ï‡∏±‡∏ß‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 1)
                    if (bet.number.length === 2 && bet.number === winningNumbers.top3?.slice(-2) && bet.betTop) {
                         isWin = true;
                    }
                    // ‡∏ï‡∏£‡∏ß‡∏à 3 ‡∏ï‡∏±‡∏ß‡πÇ‡∏ï‡πä‡∏î
                    if (bet.number.length === 3 && bet.betTod && sortString(bet.number) === sortString(winningNumbers.top3)) {
                        isWin = true;
                    }

                    if (isWin) {
                        finalHtml += `<div class="result-item win">‡πÄ‡∏•‡∏Ç ${bet.number}</div>`;
                    } else {
                        finalHtml += `<div class="result-item lose">‡πÄ‡∏•‡∏Ç ${bet.number}</div>`;
                    }
                });

                resultContainer.innerHTML = finalHtml;

            } catch (error) {
                console.error("Error:", error);
                resultContainer.innerHTML = '<p style="color:red;">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</p>';
            } finally {
                loader.style.display = 'none';
                checkButton.disabled = false;
            }
        }
    </script>
</body>
</html>
